import{h as Ye,i as ie,_ as He,c as d,a as t,b as c,t as y,n as S,w as v,d as U,j as k,F as I,r as q,k as Ke,l as L,v as Qe,m as Ze,p as $e,e as C,f as x,g as E,q as R,s as re,x as et,E as _,y as ce,u as tt,o as r,z as de,A as me}from"./index-DIpLPPCx.js";import{u as ot}from"./user-BYDqDzHk.js";const st=Ye("chat",{state:()=>({messages:[],isLoading:!1,error:null}),getters:{getMessages:h=>h.messages},actions:{async fetchMessages(){this.isLoading=!0;try{const h=await ie.get("/messages");this.messages=h.data,this.error=null}catch(h){this.error=h.response&&h.response.data&&h.response.data.message||"Ëé∑ÂèñÊ∂àÊÅØÂ§±Ë¥•"}finally{this.isLoading=!1}},async sendMessage(h){try{console.log("storeÊî∂Âà∞Ê∂àÊÅØ:",h);let e={};if(typeof h=="string")e={type:"text",content:h};else if(typeof h=="object"&&h!==null){if(e=h,e.type||(e.type="text"),!e.content)throw new Error("Ê∂àÊÅØÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫")}else throw new Error("Êó†ÊïàÁöÑÊ∂àÊÅØÊ†ºÂºè");console.log("ÂáÜÂ§áÂèëÈÄÅÂà∞ÊúçÂä°Âô®ÁöÑÊï∞ÊçÆ:",e);try{const G=await ie.post("/messages",e);return console.log("ÊúçÂä°Âô®ÂìçÂ∫î:",G.data),this.messages.push(G.data),{success:!0}}catch(G){return console.error("APIËØ∑Ê±ÇÈîôËØØ:",G),{success:!1,message:G.response&&G.response.data&&G.response.data.message||"ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•"}}}catch(e){return console.error("ÂèëÈÄÅÊ∂àÊÅØÂ§ÑÁêÜÈîôËØØ:",e),{success:!1,message:e.message||"ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•"}}},addMessage(h){this.messages.push(h)}}}),at={name:"Chat",setup(){const h=tt(),e=ot(),G=st(),o=x(null),D=x(""),O=x(!1),p=x(!1),N=x("chat"),T=x("list"),J=x("guesser"),M=E({word:"",hint:"",guess:""}),g=E({playerChoice:"",computerChoice:"",result:""}),P=E({word:""}),l=E({question:"",options:["",""],myVote:-1,activeVote:null}),F=E({color:"#000",size:10}),H=["#000","#409eff","#67c23a","#e6a23c","#f56c6c","#909399"],K=R(()=>{const s=document.querySelector(".drawing-canvas");if(!s)return!0;const u=s.getContext("2d").getImageData(0,0,s.width,s.height).data;for(let f=0;f<u.length;f+=4)if(u[f]!==255||u[f+1]!==255||u[f+2]!==255)return!1;return!0}),W=R(()=>l.question.trim()!==""&&l.options.every(s=>s.trim()!=="")),n=R(()=>{var s;return l.activeVote?l.activeVote.creator===((s=m.value)==null?void 0:s.username):!1}),V=R(()=>({guess:{title:"ÁåúËØçÊ∏∏Êàè"},rps:{title:"Áü≥Â§¥Ââ™ÂàÄÂ∏É"},vote:{title:"ÂÆ∂Â∫≠ÊäïÁ•®"},draw:{title:"‰Ω†ÁîªÊàëÁåú"}})[T.value]||{}),m=R(()=>e.getUser),B=R(()=>G.getMessages),X=["üòä","üòÇ","‚ù§Ô∏è","üëç","üòç","üéâ","üî•","üòé","ü§î","üò¢","üò¥","üôè","üëã","üåπ","üéÇ","‚òï","üåû","üåô","üçï","üè†"],te=R(()=>{const s={};return B.value.forEach(a=>{const i=new Date(a.createdAt).toLocaleDateString();s[i]||(s[i]=[]),s[i].push(a)}),s}),ue=s=>{N.value=s,T.value&&s!=="games"&&(T.value=null)},ve=s=>{T.value=s,s==="guess"&&(J.value=Math.random()>.5?"creator":"guesser"),s==="rps"&&oe()},ge=()=>{T.value=null},fe=()=>{if(!M.word||!M.hint){_.warning("ËØ∑ËæìÂÖ•ËØçËØ≠ÂíåÊèêÁ§∫");return}_.success("Â∑≤Âá∫È¢òÔºåÁ≠âÂæÖ‰ªñ‰∫∫ÁåúÊµã")},pe=()=>{if(!M.guess){_.warning("ËØ∑ËæìÂÖ•‰Ω†ÁöÑÁåúÊµã");return}setTimeout(()=>{Math.random()>.5?_.success("ÊÅ≠Âñú‰Ω†ÔºåÁåúÂØπ‰∫ÜÔºÅ"):_.error("ÁåúÈîô‰∫ÜÔºåÁªßÁª≠Âä†Ê≤πÔºÅ"),M.guess=""},500)},ye=s=>{g.playerChoice=s;const a=["rock","scissors","paper"];g.computerChoice=a[Math.floor(Math.random()*a.length)],g.playerChoice===g.computerChoice?g.result="draw":g.playerChoice==="rock"&&g.computerChoice==="scissors"||g.playerChoice==="scissors"&&g.computerChoice==="paper"||g.playerChoice==="paper"&&g.computerChoice==="rock"?g.result="win":g.result="lose"},oe=()=>{g.playerChoice="",g.computerChoice="",g.result=""},he=s=>{const a=new Date().toLocaleDateString(),i=new Date(Date.now()-864e5).toLocaleDateString();return s===a?"‰ªäÂ§©":s===i?"Êò®Â§©":s},we=s=>{const a=new Date(s);return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},ke=s=>{typeof D.value!="string"&&(D.value=""),D.value+=s,p.value=!1};re(()=>B.value.length,async()=>{await me(),o.value&&(o.value.scrollTop=o.value.scrollHeight)});const j=async()=>{if(!(!D.value.trim()&&!w.show)){O.value=!0;try{if(w.show)await Ce();else if(typeof D.value=="string"){const s={type:"text",content:D.value};console.log("ÂáÜÂ§áÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØ:",s);const a=await G.sendMessage(s);console.log("ÂèëÈÄÅÊñáÊú¨Ê∂àÊÅØÁªìÊûú:",a),a.success?D.value="":_.error(a.message||"Ê∂àÊÅØÂèëÈÄÅÂ§±Ë¥•")}else{const s=D.value;console.log("ÂáÜÂ§áÂèëÈÄÅÁâπÊÆäÊ∂àÊÅØ:",s);const a=await G.sendMessage(s);console.log("ÂèëÈÄÅÁâπÊÆäÊ∂àÊÅØÁªìÊûú:",a),a.success?D.value="":_.error(a.message||"Ê∂àÊÅØÂèëÈÄÅÂ§±Ë¥•")}}catch(s){console.error("ÂèëÈÄÅÊ∂àÊÅØÊó∂ÂèëÁîüÈîôËØØ:",s),_.error("ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•: "+(s.message||"Êú™Áü•ÈîôËØØ"))}finally{O.value=!1,p.value=!1}}},Ce=async()=>{var s,a;if(w.file)try{const i=new FormData;i.append("file",w.file);let u=D.value.trim()||w.name;i.append("caption",u);const f=await ce.post("/api/upload",i,{headers:{"Content-Type":"multipart/form-data"}});if(f.data&&f.data.fileUrl){const b={type:w.type==="image"?"image":"file",content:u,fileUrl:f.data.fileUrl,fileName:w.name,fileSize:w.file.size},A=await G.sendMessage(b);A.success?(D.value="",se(),_.success("Êñá‰ª∂ÂèëÈÄÅÊàêÂäü")):_.error(A.message||"Êñá‰ª∂Ê∂àÊÅØÂèëÈÄÅÂ§±Ë¥•")}}catch(i){console.error("Êñá‰ª∂‰∏ä‰º†ÈîôËØØ:",i),_.error("Êñá‰ª∂‰∏ä‰º†Â§±Ë¥•: "+(((a=(s=i.response)==null?void 0:s.data)==null?void 0:a.message)||i.message||"Êú™Áü•ÈîôËØØ"))}},Ve=async()=>{try{await G.fetchMessages(),_.success("Â∑≤Êõ¥Êñ∞ÊúÄÊñ∞Ê∂àÊÅØ")}catch{_.error("Ëé∑ÂèñÊ∂àÊÅØÂ§±Ë¥•")}},_e=()=>{e.logout(),h.push("/")},Ge=s=>{const a=s.target,i=a.getContext("2d"),u=a.getBoundingClientRect(),f=s.clientX-u.left,b=s.clientY-u.top;i.beginPath(),i.moveTo(f,b),a.isDrawing=!0},be=s=>{const a=s.target;if(!a.isDrawing)return;const i=a.getContext("2d"),u=a.getBoundingClientRect(),f=s.clientX-u.left,b=s.clientY-u.top;i.lineTo(f,b),i.strokeStyle=F.color,i.lineWidth=F.size,i.lineCap="round",i.lineJoin="round",i.stroke()},Me=()=>{const s=document.querySelector(".drawing-canvas");s&&(s.isDrawing=!1)},De=s=>{s.preventDefault();const a=s.target,i=a.getContext("2d"),u=a.getBoundingClientRect(),f=s.touches[0].clientX-u.left,b=s.touches[0].clientY-u.top;i.beginPath(),i.moveTo(f,b),a.isDrawing=!0},Te=s=>{s.preventDefault();const a=s.target;if(!a.isDrawing)return;const i=a.getContext("2d"),u=a.getBoundingClientRect(),f=s.touches[0].clientX-u.left,b=s.touches[0].clientY-u.top;i.lineTo(f,b),i.strokeStyle=F.color,i.lineWidth=F.size,i.lineCap="round",i.lineJoin="round",i.stroke()},Q=()=>{const s=document.querySelector(".drawing-canvas");if(s){const a=s.getContext("2d");a.fillStyle="white",a.fillRect(0,0,s.width,s.height)}},xe=()=>{const s=document.querySelector(".drawing-canvas");s&&(s.toDataURL("image/png"),P.word.trim()&&`${P.word}`,j(),Q(),P.word="")},Se=()=>{const s=document.querySelector(".drawing-canvas");s&&(s.width=s.offsetWidth,s.height=s.offsetHeight,Q())};re(()=>T.value,s=>{s==="draw"&&me(()=>{Se()})});const Ue=()=>{l.options.push("")},Pe=s=>{l.options.length>2&&l.options.splice(s,1)},Fe=()=>{var s;l.activeVote={id:Date.now().toString(),question:l.question,options:l.options.filter(a=>a.trim()!=="").map(a=>({text:a,votes:0,voters:[]})),creator:(s=m.value)==null?void 0:s.username,createdAt:new Date,totalVotes:0},j({content:`ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÊäïÁ•®: "${l.question}"`,voteData:l.activeVote}),l.question="",l.options=["",""],l.myVote=-1},Re=s=>{var i,u;if(!l.activeVote)return;if(l.myVote!==-1){const f=l.activeVote.options[l.myVote];f.votes--;const b=f.voters.indexOf((i=m.value)==null?void 0:i.username);b!==-1&&f.voters.splice(b,1),l.activeVote.totalVotes--}const a=l.activeVote.options[s];a.votes++,a.voters.push((u=m.value)==null?void 0:u.username),l.activeVote.totalVotes++,l.myVote=s,j({content:`ÊäïÁ•®ÈÄâÊã©‰∫Ü: "${a.text}"`,voteId:l.activeVote.id})},Ee=()=>{if(!l.activeVote)return;let s=-1,a=[];l.activeVote.options.forEach((u,f)=>{u.votes>s?(s=u.votes,a=[f]):u.votes===s&&a.push(f)});let i=`ÊäïÁ•®ÁªìÊûú: "${l.activeVote.question}"
`;l.activeVote.totalVotes===0?i+="Ê≤°Êúâ‰∫∫ÊäïÁ•®":a.length===1?i+=`Ëé∑ËÉúÈÄâÈ°π: "${l.activeVote.options[a[0]].text}" (${l.activeVote.options[a[0]].votes}Á•®)`:i+=`Âπ≥Â±Ä! ÈÄâÈ°π: ${a.map(u=>`"${l.activeVote.options[u].text}"`).join(", ")} ÂêÑËé∑Âæó ${s} Á•®`,j({voteId:l.activeVote.id,results:{totalVotes:l.activeVote.totalVotes}}),l.activeVote=null,l.myVote=-1},ze=()=>{l.question="",l.options=["",""]},Ae=()=>{T.value="list",l.activeVote=null,l.myVote=-1},Ie=s=>{s&&(T.value="vote",l.activeVote=s,l.myVote=-1,s.options.forEach((a,i)=>{var u;a.voters.includes((u=m.value)==null?void 0:u.username)&&(l.myVote=i)}))},qe=s=>{if(l.activeVote&&s.voteId===l.activeVote.id){const a=l.activeVote.options[s.optionIndex];a.votes++,a.voters.push(s.sender),l.activeVote.totalVotes++}},Be=s=>{l.activeVote&&s.voteId===l.activeVote.id&&(l.activeVote=null,l.myVote=-1)},je=s=>!l.activeVote||l.activeVote.totalVotes===0?0:Math.round(s/l.activeVote.totalVotes*100),w=E({show:!1,type:"",url:"",file:null,name:""}),Le=s=>{const a=s.raw.type.startsWith("image/");w.file=s.raw,w.name=s.name,w.type=a?"image":"file",w.show=!0,a&&(w.url=URL.createObjectURL(s.raw))},se=()=>{w.show=!1,w.file=null,w.url="",w.name="",w.type="",Z.value&&Z.value.clearFiles()},Z=x(null),Oe=s=>{if(!s||s===0)return"0 B";const a=1024,i=["B","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,u)).toFixed(2))+" "+i[u]},ae=x(!1),z=E({username:"",nickname:"",theme:localStorage.getItem("theme")||"light"}),$=x(!1),ne=x(""),Y=x(null),Ne=R(()=>{var s,a;return(s=m.value)!=null&&s.avatar?m.value.avatar:`https://ui-avatars.com/api/?name=${((a=m.value)==null?void 0:a.username)||"U"}&background=random`}),ee=s=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},le=()=>{const s=localStorage.getItem("theme")||"light";ee(s),z.theme=s},Je=()=>{const s=document.createElement("input");s.type="file",s.accept="image/*",s.onchange=a=>{const i=a.target.files[0];if(i){Y.value=i;const u=new FileReader;u.onload=f=>{ne.value=f.target.result},u.readAsDataURL(i)}},s.click()},We=async()=>{var s,a,i;if(!z.username.trim()){_.warning("Áî®Êà∑Âêç‰∏çËÉΩ‰∏∫Á©∫");return}$.value=!0;try{let u=(s=m.value)==null?void 0:s.avatar;if(Y.value){const b=new FormData;b.append("file",Y.value);const A=await ce.post("/api/upload",b,{headers:{"Content-Type":"multipart/form-data"}});A.data&&A.data.fileUrl&&(u=A.data.fileUrl)}const f={username:z.username,nickname:z.nickname,avatar:u};ee(z.theme),ae.value=!1,_.success("‰∏™‰∫∫ËµÑÊñô‰øùÂ≠òÊàêÂäü")}catch(u){console.error("‰øùÂ≠òËµÑÊñôÈîôËØØ:",u),_.error("‰øùÂ≠ò‰∏™‰∫∫ËµÑÊñôÂ§±Ë¥•: "+(((i=(a=u.response)==null?void 0:a.data)==null?void 0:i.message)||u.message))}finally{$.value=!1}},Xe=()=>{};return et(async()=>{await G.fetchMessages(),le()}),{chatContentRef:o,messageContent:D,sending:O,currentUser:m,messages:B,showEmojiPicker:p,emojis:X,groupedMessages:te,activeTab:N,currentGame:T,gameInfo:V,gameRole:J,guessGame:M,rpsGame:g,drawGame:P,drawingTool:F,drawingColors:H,canvasIsEmpty:K,formatDate:he,formatTime:we,insertEmoji:ke,sendMessage:j,fetchMessages:Ve,handleLogout:_e,switchTab:ue,startGame:ve,closeGame:ge,submitGuessGame:fe,submitGuess:pe,makeRPSChoice:ye,resetRPSGame:oe,startDrawing:Ge,draw:be,stopDrawing:Me,handleTouchStart:De,handleTouchMove:Te,clearCanvas:Q,shareDrawing:xe,canCreateVote:W,isVoteCreator:n,voteGame:l,addVoteOption:Ue,removeVoteOption:Pe,createVote:Fe,castVote:Re,endVote:Ee,cancelVote:ze,exitVoteResults:Ae,handleJoinVote:Ie,handleVoteReceived:qe,handleVoteEnded:Be,calculateVotePercentage:je,filePreview:w,handleFileChange:Le,cancelFileUpload:se,upload:Z,formatFileSize:Oe,showProfileModal:ae,profileForm:z,savingProfile:$,previewAvatar:ne,avatarFile:Y,triggerAvatarUpload:Je,handleAvatarChange:Xe,saveProfile:We,initTheme:le,applyTheme:ee,userAvatar:Ne}}},nt={class:"chat-container"},lt={class:"chat-sidebar"},it={class:"user-info"},rt=["src"],ct={class:"username"},dt={class:"menu"},mt={class:"logout-btn"},ut={class:"chat-main"},vt={key:0},gt={class:"chat-header"},ft={class:"header-actions"},pt={class:"chat-content",ref:"chatContentRef"},yt={key:0,class:"empty-message"},ht={key:1,class:"messages-timeline"},wt={class:"date-divider"},kt={class:"message-avatar"},Ct={class:"message-body"},Vt={class:"message-info"},_t={class:"username"},Gt={class:"time"},bt={key:0,class:"message-content"},Mt={key:1,class:"system-message"},Dt={key:2,class:"game-message"},Tt={key:3,class:"drawing-message"},xt={class:"drawing-message-header"},St={class:"drawing-image"},Ut=["src"],Pt={key:4,class:"vote-message"},Ft={class:"vote-message-header"},Rt={class:"vote-message-action"},Et={key:5,class:"vote-cast-message"},zt={key:6,class:"vote-result-message"},At={class:"vote-result-content"},It={key:7,class:"file-message"},qt={class:"file-message-header"},Bt={class:"file-message-body"},jt={class:"file-info"},Lt={class:"file-name"},Ot={class:"file-size"},Nt=["href"],Jt={key:8,class:"image-message"},Wt={class:"image-message-header"},Xt={class:"image-container"},Yt={class:"chat-input-container"},Ht={class:"input-container"},Kt={class:"emoji-container"},Qt={key:0,class:"emoji-picker"},Zt={class:"emoji-list"},$t=["onClick"],eo={class:"file-upload-container"},to={key:1,class:"file-info-preview"},oo={key:1,class:"games-container"},so={class:"games-grid"},ao={key:0,class:"game-playground"},no={class:"game-header"},lo={key:0,class:"guess-game"},io={key:0,class:"game-creator-panel"},ro={key:1,class:"game-guesser-panel"},co={class:"hint-box"},mo={key:1,class:"rps-game"},uo={class:"rps-choices"},vo={key:0,class:"rps-result"},go={class:"computer-choice"},fo={key:0},po={key:1},yo={key:2},ho={key:0},wo={key:1},ko={key:2},Co={key:2,class:"draw-game"},Vo={class:"drawing-area"},_o={class:"drawing-tools"},Go={class:"tool-group"},bo={class:"color-picker"},Mo=["onClick"],Do={class:"tool-group"},To={class:"drawing-hint"},xo={key:3,class:"vote-game"},So={key:0},Uo={class:"vote-header"},Po={class:"vote-creator"},Fo={class:"vote-options"},Ro=["onClick"],Eo={class:"option-content"},zo={class:"option-text"},Ao={class:"vote-progress"},Io={class:"vote-count"},qo={class:"vote-actions"},Bo={key:1,class:"create-vote"},jo={class:"option-input"},Lo={class:"form-actions"},Oo={key:2,class:"users-container"},No={key:3,class:"settings-container"},Jo={class:"profile-settings"},Wo={class:"avatar-settings"},Xo=["src"],Yo={class:"profile-form"},Ho={slot:"footer",class:"dialog-footer"};function Ko(h,e,G,o,D,O){var W;const p=U("el-button"),N=U("el-empty"),T=U("el-image"),J=U("el-upload"),M=U("el-input"),g=U("el-form-item"),P=U("el-form"),l=U("el-slider"),F=U("el-radio"),H=U("el-radio-group"),K=U("el-dialog");return r(),d("div",nt,[t("div",lt,[e[40]||(e[40]=t("div",{class:"logo"},[t("h2",null,"ÂÆ∂Â∫≠ËÅäÂ§©")],-1)),t("div",it,[t("div",{class:"avatar",onClick:e[0]||(e[0]=n=>o.showProfileModal=!0)},[t("img",{src:o.userAvatar,alt:"Áî®Êà∑Â§¥ÂÉè"},null,8,rt),e[34]||(e[34]=t("div",{class:"avatar-edit-hint"},[t("i",{class:"el-icon-edit"})],-1))]),t("div",ct,y((W=o.currentUser)==null?void 0:W.username),1)]),t("div",dt,[t("div",{class:S(["menu-item",{active:o.activeTab==="chat"}]),onClick:e[1]||(e[1]=n=>o.switchTab("chat"))},e[35]||(e[35]=[t("i",{class:"el-icon-chat-dot-round"},null,-1),t("span",null,"ËÅäÂ§©ÂÆ§",-1)]),2),t("div",{class:S(["menu-item",{active:o.activeTab==="games"}]),onClick:e[2]||(e[2]=n=>o.switchTab("games"))},e[36]||(e[36]=[t("i",{class:"el-icon-trophy"},null,-1),t("span",null,"Ê∏∏Êàè‰∏≠ÂøÉ",-1)]),2),t("div",{class:S(["menu-item",{active:o.activeTab==="users"}]),onClick:e[3]||(e[3]=n=>o.switchTab("users"))},e[37]||(e[37]=[t("i",{class:"el-icon-user"},null,-1),t("span",null,"Áî®Êà∑ÂàóË°®",-1)]),2),t("div",{class:S(["menu-item",{active:o.activeTab==="settings"}]),onClick:e[4]||(e[4]=n=>o.switchTab("settings"))},e[38]||(e[38]=[t("i",{class:"el-icon-setting"},null,-1),t("span",null,"ËÆæÁΩÆ",-1)]),2)]),t("div",mt,[c(p,{type:"danger",onClick:o.handleLogout,plain:""},{default:v(()=>e[39]||(e[39]=[C("ÈÄÄÂá∫ÁôªÂΩï")])),_:1},8,["onClick"])])]),t("div",ut,[o.activeTab==="chat"?(r(),d("div",vt,[t("div",gt,[e[42]||(e[42]=t("h3",null,"ÂÆ∂Â∫≠ËÅäÂ§©ÂÆ§",-1)),t("div",ft,[e[41]||(e[41]=t("span",{class:"online-count"},"Âú®Á∫ø‰∫∫Êï∞: 1",-1)),c(p,{type:"primary",size:"small",icon:"el-icon-refresh-right",circle:"",onClick:o.fetchMessages},null,8,["onClick"])])]),t("div",pt,[o.messages.length===0?(r(),d("div",yt,[c(N,{description:"ÊöÇÊó†Ê∂àÊÅØÔºåÂºÄÂßãËÅäÂ§©ÂêßÔºÅ"})])):(r(),d("div",ht,[(r(!0),d(I,null,q(o.groupedMessages,(n,V)=>(r(),d("div",{key:V},[t("div",wt,[t("span",null,y(o.formatDate(V)),1)]),(r(!0),d(I,null,q(n,(m,B)=>{var X;return r(),d("div",{key:m.id||B,class:S(["message-item",{"my-message":m.userId===((X=o.currentUser)==null?void 0:X.id)}])},[t("div",kt,y(m.username.charAt(0).toUpperCase()),1),t("div",Ct,[t("div",Vt,[t("span",_t,y(m.username),1),t("span",Gt,y(o.formatTime(m.createdAt)),1)]),m.type==="text"?(r(),d("div",bt,y(m.content),1)):m.type==="system"?(r(),d("div",Mt,y(m.content),1)):m.type==="game"?(r(),d("div",Dt,[e[43]||(e[43]=t("i",{class:"el-icon-data-analysis"},null,-1)),t("span",null,y(m.content),1)])):m.type==="drawing"?(r(),d("div",Tt,[t("div",xt,[e[44]||(e[44]=t("i",{class:"el-icon-picture-outline"},null,-1)),t("span",null,y(m.content),1)]),t("div",St,[t("img",{src:m.drawingData,alt:"Áî®Êà∑ÁªòÁîª"},null,8,Ut)])])):m.type==="vote"?(r(),d("div",Pt,[t("div",Ft,[e[45]||(e[45]=t("i",{class:"el-icon-s-check"},null,-1)),t("span",null,y(m.content),1)]),t("div",Rt,[c(p,{size:"small",type:"primary",onClick:te=>o.handleJoinVote(m.voteData)},{default:v(()=>e[46]||(e[46]=[C("ÂèÇ‰∏éÊäïÁ•®")])),_:2},1032,["onClick"])])])):m.type==="vote-cast"?(r(),d("div",Et,[e[47]||(e[47]=t("i",{class:"el-icon-check"},null,-1)),t("span",null,y(m.content),1)])):m.type==="vote-end"?(r(),d("div",zt,[e[48]||(e[48]=t("div",{class:"vote-result-header"},[t("i",{class:"el-icon-trophy"}),t("span",null,"ÊäïÁ•®ÁªìÊùü")],-1)),t("div",At,[t("pre",null,y(m.content),1)])])):m.type==="file"?(r(),d("div",It,[t("div",qt,[e[49]||(e[49]=t("i",{class:"el-icon-document"},null,-1)),t("span",null,y(m.content),1)]),t("div",Bt,[e[51]||(e[51]=t("i",{class:"el-icon-document file-icon"},null,-1)),t("div",jt,[t("div",Lt,y(m.fileName),1),t("div",Ot,y(o.formatFileSize(m.fileSize)),1)]),t("a",{href:m.fileUrl,target:"_blank",class:"file-download"},[c(p,{size:"mini",type:"primary",icon:"el-icon-download"},{default:v(()=>e[50]||(e[50]=[C("‰∏ãËΩΩ")])),_:1})],8,Nt)])])):m.type==="image"?(r(),d("div",Jt,[t("div",Wt,[e[52]||(e[52]=t("i",{class:"el-icon-picture-outline"},null,-1)),t("span",null,y(m.content),1)]),t("div",Xt,[c(T,{src:m.fileUrl,"preview-src-list":[m.fileUrl],fit:"cover",class:"chat-image"},{default:v(()=>e[53]||(e[53]=[t("div",{slot:"error",class:"image-error"},[t("i",{class:"el-icon-picture-outline"})],-1)])),_:2},1032,["src","preview-src-list"])])])):k("",!0)])],2)}),128))]))),128))]))],512),t("div",Yt,[t("div",Ht,[t("div",Kt,[c(p,{class:"emoji-btn",icon:"el-icon-smile",circle:"",onClick:e[5]||(e[5]=n=>o.showEmojiPicker=!o.showEmojiPicker)}),o.showEmojiPicker?(r(),d("div",Qt,[t("div",Zt,[(r(!0),d(I,null,q(o.emojis,n=>(r(),d("span",{key:n,onClick:V=>o.insertEmoji(n)},y(n),9,$t))),128))])])):k("",!0)]),t("div",eo,[c(J,{ref:"upload",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":o.handleFileChange,limit:1},{default:v(()=>[c(p,{icon:"el-icon-paperclip",circle:""})]),_:1},8,["on-change"]),o.filePreview.show&&o.filePreview.type==="image"?(r(),L(T,{key:0,src:o.filePreview.url,class:"file-preview",fit:"contain"},{default:v(()=>e[54]||(e[54]=[t("div",{slot:"error",class:"image-error"},[t("i",{class:"el-icon-picture-outline"})],-1)])),_:1},8,["src"])):k("",!0),o.filePreview.show&&o.filePreview.type==="file"?(r(),d("div",to,[e[55]||(e[55]=t("i",{class:"el-icon-document"},null,-1)),t("span",null,y(o.filePreview.name),1),c(p,{type:"text",icon:"el-icon-close",onClick:o.cancelFileUpload},null,8,["onClick"])])):k("",!0)]),Ke(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=n=>o.messageContent=n),placeholder:"ËæìÂÖ•Ê∂àÊÅØ...",onKeydown:e[7]||(e[7]=Ze($e((...n)=>o.sendMessage&&o.sendMessage(...n),["ctrl"]),["enter"]))},null,544),[[Qe,o.messageContent]]),c(p,{type:"primary",circle:"",icon:"el-icon-s-promotion",onClick:o.sendMessage,loading:o.sending,disabled:!o.messageContent.trim()&&!o.filePreview.show},null,8,["onClick","loading","disabled"])]),e[56]||(e[56]=t("div",{class:"input-tip"},"Êåâ Ctrl + Enter ÂèëÈÄÅÊ∂àÊÅØ",-1))])])):k("",!0),o.activeTab==="games"?(r(),d("div",oo,[e[84]||(e[84]=t("div",{class:"section-header"},[t("h3",null,"ÂÆ∂Â∫≠Ê∏∏Êàè‰∏≠ÂøÉ"),t("p",{class:"section-desc"},"ÂíåÂÆ∂‰∫∫‰∏ÄËµ∑Áé©Ê∏∏ÊàèÔºåÂ¢ûËøõÊÑüÊÉÖ")],-1)),t("div",so,[t("div",{class:"game-card",onClick:e[8]||(e[8]=n=>o.startGame("guess"))},e[57]||(e[57]=[t("div",{class:"game-icon"},"üéÆ",-1),t("div",{class:"game-title"},"ÁåúËØçÊ∏∏Êàè",-1),t("div",{class:"game-desc"},"ÁåúÁåúÊàëÂú®ÊÉ≥‰ªÄ‰πàÔºüËÄÉÈ™å‰Ω†‰ª¨‰πãÈó¥ÁöÑÈªòÂ•ë",-1)])),t("div",{class:"game-card",onClick:e[9]||(e[9]=n=>o.startGame("rps"))},e[58]||(e[58]=[t("div",{class:"game-icon"},"‚úÇÔ∏è",-1),t("div",{class:"game-title"},"Áü≥Â§¥Ââ™ÂàÄÂ∏É",-1),t("div",{class:"game-desc"},"ÁªèÂÖ∏Ê∏∏ÊàèÔºåÁ∫ø‰∏äÂØπÂÜ≥",-1)])),t("div",{class:"game-card",onClick:e[10]||(e[10]=n=>o.startGame("vote"))},e[59]||(e[59]=[t("div",{class:"game-icon"},"üìä",-1),t("div",{class:"game-title"},"ÂÆ∂Â∫≠ÊäïÁ•®",-1),t("div",{class:"game-desc"},"‰ªäÂ§©ÂêÉ‰ªÄ‰πàÔºüÂéªÂì™ÈáåÁé©Ôºü‰∏ÄËµ∑ÂÜ≥ÂÆö",-1)])),t("div",{class:"game-card",onClick:e[11]||(e[11]=n=>o.startGame("draw"))},e[60]||(e[60]=[t("div",{class:"game-icon"},"üé®",-1),t("div",{class:"game-title"},"‰Ω†ÁîªÊàëÁåú",-1),t("div",{class:"game-desc"},"ÂèëÊå•‰Ω†ÁöÑËâ∫ÊúØÂ§©ËµãÔºåÁúãË∞ÅÁåúÂæóÂø´",-1)]))]),o.currentGame?(r(),d("div",ao,[t("div",no,[t("h4",null,y(o.gameInfo.title),1),c(p,{size:"small",onClick:o.closeGame,type:"text"},{default:v(()=>e[61]||(e[61]=[C("ËøîÂõûÊ∏∏ÊàèÂàóË°®")])),_:1},8,["onClick"])]),o.currentGame==="guess"?(r(),d("div",lo,[e[67]||(e[67]=t("div",{class:"game-rules"},[t("p",null,"Ê∏∏ÊàèËßÑÂàôÔºö‰∏Ä‰∫∫ÈÄâÊã©‰∏Ä‰∏™ËØçÔºåÁªôÂá∫ÊèêÁ§∫ÔºåÂÖ∂‰ªñ‰∫∫ÁåúËøô‰∏™ËØçÊòØ‰ªÄ‰πà„ÄÇ")],-1)),o.gameRole==="creator"?(r(),d("div",io,[e[63]||(e[63]=t("h5",null,"‰Ω†ÊòØÂá∫È¢òËÄÖ",-1)),c(P,null,{default:v(()=>[c(g,{label:"ÈÄâÊã©‰∏Ä‰∏™ËØç"},{default:v(()=>[c(M,{modelValue:o.guessGame.word,"onUpdate:modelValue":e[12]||(e[12]=n=>o.guessGame.word=n),placeholder:"ËæìÂÖ•‰∏Ä‰∏™ËØç"},null,8,["modelValue"])]),_:1}),c(g,{label:"ÁªôÂá∫ÊèêÁ§∫"},{default:v(()=>[c(M,{modelValue:o.guessGame.hint,"onUpdate:modelValue":e[13]||(e[13]=n=>o.guessGame.hint=n),placeholder:"ÁªôÂÖ∂‰ªñ‰∫∫‰∏Ä‰∫õÊèêÁ§∫"},null,8,["modelValue"])]),_:1}),c(g,null,{default:v(()=>[c(p,{type:"primary",onClick:o.submitGuessGame},{default:v(()=>e[62]||(e[62]=[C("ÂºÄÂßãÊ∏∏Êàè")])),_:1},8,["onClick"])]),_:1})]),_:1})])):(r(),d("div",ro,[e[66]||(e[66]=t("h5",null,"‰Ω†ÊòØÁåúËØçËÄÖ",-1)),t("div",co,[e[64]||(e[64]=t("h6",null,"ÊèêÁ§∫Ôºö",-1)),t("p",null,y(o.guessGame.hint||"Á≠âÂæÖÂá∫È¢òËÄÖÁªôÂá∫ÊèêÁ§∫..."),1)]),o.guessGame.hint?(r(),L(P,{key:0},{default:v(()=>[c(g,{label:"‰Ω†ÁöÑÁåúÊµã"},{default:v(()=>[c(M,{modelValue:o.guessGame.guess,"onUpdate:modelValue":e[14]||(e[14]=n=>o.guessGame.guess=n),placeholder:"Áåú‰∏ÄÁåúÊòØ‰ªÄ‰πàËØç"},null,8,["modelValue"])]),_:1}),c(g,null,{default:v(()=>[c(p,{type:"primary",onClick:o.submitGuess},{default:v(()=>e[65]||(e[65]=[C("Êèê‰∫§ÁåúÊµã")])),_:1},8,["onClick"])]),_:1})]),_:1})):k("",!0)]))])):k("",!0),o.currentGame==="rps"?(r(),d("div",mo,[e[73]||(e[73]=t("div",{class:"game-rules"},[t("p",null,"Ê∏∏ÊàèËßÑÂàôÔºöÈÄâÊã©Áü≥Â§¥„ÄÅÂâ™ÂàÄÊàñÂ∏ÉÔºåÁúãÁúãË∞ÅÊòØËµ¢ÂÆ∂ÔºÅ")],-1)),t("div",uo,[t("div",{class:S(["rps-choice",{selected:o.rpsGame.playerChoice==="rock"}]),onClick:e[15]||(e[15]=n=>o.makeRPSChoice("rock"))},e[68]||(e[68]=[t("div",{class:"choice-icon"},"üëä",-1),t("div",{class:"choice-name"},"Áü≥Â§¥",-1)]),2),t("div",{class:S(["rps-choice",{selected:o.rpsGame.playerChoice==="scissors"}]),onClick:e[16]||(e[16]=n=>o.makeRPSChoice("scissors"))},e[69]||(e[69]=[t("div",{class:"choice-icon"},"‚úåÔ∏è",-1),t("div",{class:"choice-name"},"Ââ™ÂàÄ",-1)]),2),t("div",{class:S(["rps-choice",{selected:o.rpsGame.playerChoice==="paper"}]),onClick:e[17]||(e[17]=n=>o.makeRPSChoice("paper"))},e[70]||(e[70]=[t("div",{class:"choice-icon"},"‚úã",-1),t("div",{class:"choice-name"},"Â∏É",-1)]),2)]),o.rpsGame.result?(r(),d("div",vo,[t("div",go,[e[71]||(e[71]=C(" ÁîµËÑëÈÄâÊã©‰∫ÜÔºö ")),o.rpsGame.computerChoice==="rock"?(r(),d("span",fo,"üëä Áü≥Â§¥")):o.rpsGame.computerChoice==="scissors"?(r(),d("span",po,"‚úåÔ∏è Ââ™ÂàÄ")):o.rpsGame.computerChoice==="paper"?(r(),d("span",yo,"‚úã Â∏É")):k("",!0)]),t("div",{class:S(["result-text",o.rpsGame.result])},[o.rpsGame.result==="win"?(r(),d("span",ho,"‰Ω†Ëµ¢‰∫ÜÔºÅüéâ")):o.rpsGame.result==="lose"?(r(),d("span",wo,"‰Ω†Ëæì‰∫ÜÔºÅüò¢")):(r(),d("span",ko,"Âπ≥Â±ÄÔºÅü§ù"))],2)])):k("",!0),o.rpsGame.result?(r(),L(p,{key:1,type:"primary",onClick:o.resetRPSGame},{default:v(()=>e[72]||(e[72]=[C("ÂÜçÊù•‰∏ÄÂ±Ä")])),_:1},8,["onClick"])):k("",!0)])):k("",!0),o.currentGame==="draw"?(r(),d("div",Co,[e[78]||(e[78]=t("div",{class:"game-rules"},[t("p",null,"Ê∏∏ÊàèËßÑÂàôÔºöÂú®ÁîªÂ∏É‰∏ä‰ΩúÁîªÔºåËÆ©ÂÆ∂‰∫∫Áåú‰Ω†ÁîªÁöÑÊòØ‰ªÄ‰πà„ÄÇ")],-1)),t("div",Vo,[t("div",_o,[t("div",Go,[e[74]||(e[74]=t("span",{class:"tool-label"},"ÁîªÁ¨îÈ¢úËâ≤:",-1)),t("div",bo,[(r(!0),d(I,null,q(o.drawingColors,n=>(r(),d("div",{class:S(["color-item",{active:o.drawingTool.color===n}]),key:n,style:de({backgroundColor:n}),onClick:V=>o.drawingTool.color=n},null,14,Mo))),128))])]),t("div",Do,[e[75]||(e[75]=t("span",{class:"tool-label"},"ÁîªÁ¨îÂ§ßÂ∞è:",-1)),c(l,{modelValue:o.drawingTool.size,"onUpdate:modelValue":e[18]||(e[18]=n=>o.drawingTool.size=n),min:1,max:20,step:1},null,8,["modelValue"])]),c(p,{type:"danger",size:"small",onClick:o.clearCanvas},{default:v(()=>e[76]||(e[76]=[C("Ê∏ÖÁ©∫ÁîªÂ∏É")])),_:1},8,["onClick"])]),t("canvas",{ref:"canvas",class:"drawing-canvas",onMousedown:e[19]||(e[19]=(...n)=>o.startDrawing&&o.startDrawing(...n)),onMousemove:e[20]||(e[20]=(...n)=>o.draw&&o.draw(...n)),onMouseup:e[21]||(e[21]=(...n)=>o.stopDrawing&&o.stopDrawing(...n)),onMouseleave:e[22]||(e[22]=(...n)=>o.stopDrawing&&o.stopDrawing(...n)),onTouchstart:e[23]||(e[23]=(...n)=>o.handleTouchStart&&o.handleTouchStart(...n)),onTouchmove:e[24]||(e[24]=(...n)=>o.handleTouchMove&&o.handleTouchMove(...n)),onTouchend:e[25]||(e[25]=(...n)=>o.stopDrawing&&o.stopDrawing(...n))},null,544),t("div",To,[c(M,{modelValue:o.drawGame.word,"onUpdate:modelValue":e[26]||(e[26]=n=>o.drawGame.word=n),placeholder:"ÂëäËØâÂ§ßÂÆ∂‰Ω†Ë¶ÅÁîª‰ªÄ‰πàÔºàÂèØÈÄâÔºâ"},null,8,["modelValue"]),c(p,{type:"primary",onClick:o.shareDrawing,disabled:!o.canvasIsEmpty},{default:v(()=>e[77]||(e[77]=[C("ÂàÜ‰∫´‰ΩúÂìÅ")])),_:1},8,["onClick","disabled"])])])])):k("",!0),o.currentGame==="vote"?(r(),d("div",xo,[e[83]||(e[83]=t("div",{class:"game-rules"},[t("p",null,"Ê∏∏ÊàèËßÑÂàôÔºöÂàõÂª∫‰∏Ä‰∏™ÊäïÁ•®ÔºåËÆ©ÂÆ∂‰∫∫ÂÖ±ÂêåÂÜ≥ÂÆöÈáçË¶Å‰∫ãÈ°π„ÄÇ")],-1)),o.voteGame.activeVote?(r(),d("div",So,[t("div",Uo,[t("h5",null,y(o.voteGame.activeVote.question),1),t("p",Po,"Áî± "+y(o.voteGame.activeVote.creator)+" ÂèëËµ∑",1)]),t("div",Fo,[(r(!0),d(I,null,q(o.voteGame.activeVote.options,(n,V)=>(r(),d("div",{key:V,class:S(["vote-option",{selected:o.voteGame.myVote===V}]),onClick:m=>o.castVote(V)},[t("div",Eo,[t("div",zo,y(n.text),1),t("div",Ao,[t("div",{class:"progress-bar",style:de({width:`${o.calculateVotePercentage(n.votes)}%`})},null,4),t("div",Io,y(n.votes)+" Á•®",1)])])],10,Ro))),128))]),t("div",qo,[o.isVoteCreator?(r(),L(p,{key:0,type:"primary",onClick:o.endVote},{default:v(()=>e[79]||(e[79]=[C("ÁªìÊùüÊäïÁ•®")])),_:1},8,["onClick"])):k("",!0),c(p,{onClick:o.exitVoteResults},{default:v(()=>e[80]||(e[80]=[C("ËøîÂõû")])),_:1},8,["onClick"])])])):(r(),d("div",Bo,[c(P,null,{default:v(()=>[c(g,{label:"ÊäïÁ•®ÈóÆÈ¢ò"},{default:v(()=>[c(M,{modelValue:o.voteGame.question,"onUpdate:modelValue":e[27]||(e[27]=n=>o.voteGame.question=n),placeholder:"‰æãÂ¶ÇÔºö‰ªäÊôöÂêÉ‰ªÄ‰πàÔºü"},null,8,["modelValue"])]),_:1}),(r(!0),d(I,null,q(o.voteGame.options,(n,V)=>(r(),d("div",{key:V,class:"option-item"},[c(g,{label:`ÈÄâÈ°π ${V+1}`},{default:v(()=>[t("div",jo,[c(M,{modelValue:o.voteGame.options[V],"onUpdate:modelValue":m=>o.voteGame.options[V]=m,placeholder:`ÈÄâÈ°π ${V+1}`},null,8,["modelValue","onUpdate:modelValue","placeholder"]),o.voteGame.options.length>2?(r(),L(p,{key:0,type:"danger",icon:"el-icon-delete",circle:"",onClick:m=>o.removeVoteOption(V)},null,8,["onClick"])):k("",!0)])]),_:2},1032,["label"])]))),128)),t("div",Lo,[c(p,{type:"primary",plain:"",onClick:o.addVoteOption},{default:v(()=>e[81]||(e[81]=[C("Ê∑ªÂä†ÈÄâÈ°π")])),_:1},8,["onClick"]),c(p,{type:"primary",onClick:o.createVote,disabled:!o.canCreateVote},{default:v(()=>e[82]||(e[82]=[C("ÂàõÂª∫ÊäïÁ•®")])),_:1},8,["onClick","disabled"])])]),_:1})]))])):k("",!0)])):k("",!0)])):k("",!0),o.activeTab==="users"?(r(),d("div",Oo,e[85]||(e[85]=[t("div",{class:"section-header"},[t("h3",null,"Áî®Êà∑ÂàóË°®")],-1),t("p",{class:"coming-soon"},"ÂäüËÉΩÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖ...",-1)]))):k("",!0),o.activeTab==="settings"?(r(),d("div",No,e[86]||(e[86]=[t("div",{class:"section-header"},[t("h3",null,"ËÆæÁΩÆ")],-1),t("p",{class:"coming-soon"},"ÂäüËÉΩÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖ...",-1)]))):k("",!0)]),c(K,{title:"‰∏™‰∫∫ËµÑÊñôËÆæÁΩÆ",visible:o.showProfileModal,width:"500px","close-on-click-modal":!1},{default:v(()=>[t("div",Jo,[t("div",Wo,[t("div",{class:"current-avatar",onClick:e[28]||(e[28]=(...n)=>o.triggerAvatarUpload&&o.triggerAvatarUpload(...n))},[t("img",{src:o.previewAvatar||o.userAvatar,alt:"Áî®Êà∑Â§¥ÂÉè"},null,8,Xo),e[87]||(e[87]=t("div",{class:"avatar-upload-hint"},[t("i",{class:"el-icon-upload"}),t("span",null,"Êõ¥ÊîπÂ§¥ÂÉè")],-1))]),t("input",{ref:"avatarInput",type:"file",style:{display:"none"},accept:"image/*",onChange:e[29]||(e[29]=(...n)=>o.handleAvatarChange&&o.handleAvatarChange(...n))},null,544)]),t("div",Yo,[c(P,{"label-width":"80px",model:o.profileForm},{default:v(()=>[c(g,{label:"Áî®Êà∑Âêç"},{default:v(()=>[c(M,{modelValue:o.profileForm.username,"onUpdate:modelValue":e[30]||(e[30]=n=>o.profileForm.username=n),disabled:!0},null,8,["modelValue"])]),_:1}),c(g,{label:"ÊòµÁß∞"},{default:v(()=>[c(M,{modelValue:o.profileForm.nickname,"onUpdate:modelValue":e[31]||(e[31]=n=>o.profileForm.nickname=n),placeholder:"ËÆæÁΩÆÊÇ®ÁöÑÊòµÁß∞"},null,8,["modelValue"])]),_:1}),c(g,{label:"‰∏ªÈ¢ò"},{default:v(()=>[c(H,{modelValue:o.profileForm.theme,"onUpdate:modelValue":e[32]||(e[32]=n=>o.profileForm.theme=n)},{default:v(()=>[c(F,{label:"light"},{default:v(()=>e[88]||(e[88]=[C("ÊµÖËâ≤")])),_:1}),c(F,{label:"dark"},{default:v(()=>e[89]||(e[89]=[C("Ê∑±Ëâ≤")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),t("span",Ho,[c(p,{onClick:e[33]||(e[33]=n=>o.showProfileModal=!1)},{default:v(()=>e[90]||(e[90]=[C("ÂèñÊ∂à")])),_:1}),c(p,{type:"primary",onClick:o.saveProfile,loading:o.savingProfile},{default:v(()=>e[91]||(e[91]=[C("‰øùÂ≠ò")])),_:1},8,["onClick","loading"])])]),_:1},8,["visible"])])}const es=He(at,[["render",Ko],["__scopeId","data-v-0bdefc54"]]);export{es as default};
